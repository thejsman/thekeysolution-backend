<template name="events_guest_list">
  <table>
    <thead>
      <tr>
        <th>App Invite Status
          <i class="tooltip-icon" data-position="top" data-delay="50" data-tooltip="One tick = invite mail with download link sent | Two ticks = Guest has logged-in"></i>
        </th>
        <th>#</th>
        <th>Folio No.
          <i class="tooltip-icon" data-position="top" data-delay="50" data-tooltip="Autogenerated from System"></i>
        </th>
        <th>Guest Name
          <i class="tooltip-icon" data-position="top" data-delay="50" data-tooltip="Clicking on the Guest's Name lets you Manage the Guest's Services, Assignments & Information"></i>
        </th>
        <th>Contact No.</th>
        <th>Email ID</th>
        <th>Family ID
          <i class="tooltip-icon" data-position="top" data-delay="50" data-tooltip="Needs to set manually, per Guest"></i>
        </th>
        <th>Password
          <i class="tooltip-icon" data-position="top" data-delay="50" data-tooltip="Autogenerated from System"></i>
        </th>
        {{#if isAllowed 'guest-invite'}}
        <th class="right-align">
          <a class="waves-effect invite-btn waves-light btn lighten-2 click_inviteall-invitation-button" style="margin-left: 1em">Send invite email
            <i class="tooltip-icon" data-position="top" data-delay="50" data-tooltip="Clicking here will send an email to all Guests to download the app"></i>
          </a>
        </th>
        {{/if}}
        <th></th>
      </tr>
    </thead>
    <tbody>
      {{#each guestList}} {{> events_guest_item index=@index info=this}} {{/each}} {{guestEmailCount}} {{> defaultBootstrapPaginator
      pagination=templatePagination limit=5 containerClass="text-center" onClick=clickEvent}}
    </tbody>
    {{> guest_edit_modal}} {{> guest_delete_confirm}} {{> guest_bulk_invite}}
  </table>
</template>

<template name="guest_bulk_invite">
  <div id="guest_invite_modal" class="modal">
    <div class="modal-content">
      <h6>Select Options</h6>
      <form id="guest_bulk_invite_form" action="#">
        <p>
          <input value="1" class="with-gap" type="radio" id="all_guest" name="guest_invite" checked/>
          <label for="all_guest">All Guests</label>
        </p>
        <p>
          <input value="2" class="with-gap" type="radio" id="not_logged_guest" name="guest_invite" />
          <label for="not_logged_guest">Not LoggedIn Guests</label>
        </p>
        <p>
          <input value="3" class="with-gap" type="radio" id="new_guest" name="guest_invite" />
          <label for="new_guest">New Guests</label>
        </p>
      </form>
    </div>
    <div class="modal-footer">
      <a class="waves-effect waves-dark btn-flat modal-close">Cancel</a>
      <button form="guest_bulk_invite_form" class="btn waves-effect waves-light red lighten-2" type="submit" name="action">
        <i class="material-icons left">send</i>
        Send Invitation
      </button>
    </div>
  </div>
</template>

<template name="events_guest_item">
  <tr>
    <td>
      <span>
        {{#if info.accessToken}}
        <i class="material-icons">done_all</i>
        {{else}} {{#if guestInviteList}}
        <i class="material-icons">done</i>
        {{else}}
        <i class="material-icons">close</i>
        {{/if}} {{/if}}
      </span>
    </td>
    <td>{{PageNumbers index}}</td>
    <td>
      {{#if isAllowed 'guest-view-details'}}
      <a href={{guestProfilePath info._id}}>
        {{padLeft info.folioNumber 5}}
      </a>
      {{else}} {{padLeft info.folioNumber 5}} {{/if}}
    </td>
    <td>
      {{#if isAllowed 'guest-view-details'}}
      <a href={{guestProfilePath info._id}}>
        {{info.guestFirstName}} {{info.guestLastName}} </a>
      <a class="tooltip-only guestProfileShow" data-position="top" data-delay="50" data-tooltip="Hide/Show"> {{#if guestCountList}} + {{/if}}
        <b>{{guestCountList}}</b>
      </a>

      {{else}} {{info.guestFirstName}} {{info.guestLastName}} {{#if guestCountList}} + {{/if}}
      <b>{{guestCountList}}</b>
      {{/if}}
    </td>
    <td>{{info.guestPhoneCode}}-{{info.guestContactNo}}</td>
    <td>{{info.guestPersonalEmail}}</td>
    <td>{{info.guestFamilyID}}</td>
    <td>{{info.accessCode}}</td>
    <td class="right-align">
      {{#if isAllowed 'guest-invite'}}
      <a class="waves-effect waves-light btn lighten-2 invite-btn click_resend-invitation-button">{{#if guestInviteList}}Resend invite email{{else}}Send invite email{{/if}}
        <i class="tooltip-icon" data-position="top"
          data-delay="50" data-tooltip="Clicking here will send an email to this Guests to download the app"></i>
      </a>
      {{/if}}
    </td>
    <td>
      <div class="action-btn">
        {{#if isAllowed 'guest-edit'}}
        <a class="waves-effect btn click_download-guest-button">
          <i class="fa fa-download tooltip-only" data-position="top" data-delay="50" data-tooltip="All images uploaded by the Guest can be downloaded from here (Photo, PhotoID, VISA etc)"></i>
        </a>
        {{/if}} {{#if isAllowed 'guest-download'}}
        <a class="waves-effect btn center-btn click_edit-guest-button">
          <i class="fa fa-pencil"></i>
        </a>
        {{/if}} {{#if isAllowed 'guest-delete'}}
        <a class="waves-effect btn click_delete-guest-button">
          <i class="fa fa-trash tooltip-only" data-position="top" data-delay="50" data-tooltip="Will delete this Guest including family. This can not be undone"></i>
        </a>
        {{/if}}
      </div>
    </td>
  </tr>
  {{#if hasGuestFamilyList}} {{#each guestFamilyList}} {{>event_guest_family info2=this index=@index}} {{/each}} {{/if}}
</template>


<template name="event_guest_family">
  <tr style="background-color: #eaeaea" class="FamilyMember{{info2.guestFamilyID}} hide">
    <td></td>
    <td>{{indexPlusOne index}}></td>
    <td>
      {{#if isAllowed 'guest-view-details'}}
      <a href={{guestProfilePath info2._id}}>
        {{padLeft info2.folioNumber 5}}
      </a>
      {{else}} {{padLeft info2.folioNumber 5}} {{/if}}
    </td>
    <td>
      {{#if isAllowed 'guest-view-details'}}
      <a href={{guestProfilePath info2._id}}>
        {{info2.guestFirstName}} {{info2.guestLastName}}
      </a>
      {{else}} {{info2.guestFirstName}} {{info2.guestLastName}} {{/if}}
    </td>
    <td>{{info2.guestContactNo}}</td>
    <td>{{info2.guestPersonalEmail}}</td>
    <td>{{info2.guestFamilyID}}</td>
    <td>{{info2.accessCode}}</td>
    <td class="right-align"></td>
    <td></td>
  </tr>
</template>